---
title: "Status of childhood immunization"
date: "September 2025"
date-format: "MMMM YYYY"
format:
   typst:
      template-partials:
         - typst-template.typ
         - typst-show.typ
params:
   state: Michigan
   end_date: "August 7, 2025"
execute:
  echo: false
  message: false
  warning: false
  fig-align: center
---

```{r}
#| output: false
library(tidyverse)
library(glue)
library(tigris)
library(sf)
library(janitor)
library(tidycensus)
library(showtext)

source("charts.R")

state <- params$state
if (is.null(state)) {
    state <- "Michigan" # Default (same in typst template)
}
state_title <- gsub(" Of ", " of ", str_to_title(state))

census_api_key(Sys.getenv("TIDYCENSUS_API_KEY"), install = FALSE)

total_measles_cases <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/total_measles_cases.csv"
)

mmr_coverage_final <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/mmr_coverage_final.csv"
) |>
    # mock data because missing
    bind_rows(data.frame(
        geography = c("Montana", "Montana", "West Virginia"),
        school_year = c("2023-24", "2024-25", "2024-25"),
        estimate_percent = c("1", "1", "1")
    ))


dtap_coverage_final <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/dtap_coverage_final.csv"
)

exemption_policies <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/non_medical_exemption_policies_final.csv"
) |>
    # mock district of columbia because currently missing from the data
    bind_rows(data.frame(
        State = "District of Columbia",
        `Personal Exemption` = "Yes",
        `Religious Exemption` = "Yes",
        `Additional Details on Exemption Exceptions & Educational Requirements` = NA
    ))

exemption <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/non_medical_exemption.csv"
) |>
    # mock data because currently missing
    # https://github.com/rfortherestofus/state-immunization-reports/issues/15
    bind_rows(data.frame(
        geography = c(
            "California",
            "California",
            "New York",
            "New York",
            "Montana",
            "Montana",
            "West Virginia",
            "West Virginia",
            "Maine"
        ),
        school_year = c(
            "2024-25",
            "2023-24",
            "2024-25",
            "2023-24",
            "2024-25",
            "2023-24",
            "2024-25",
            "2023-24",
            "2024-25"
        ),
        `Personal Exemption` = c(
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA"
        ),
        `Religious Exemption` = c(
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA",
            "NA"
        ),
        estimate_percent = c(1, 1, 1, 1, 1, 1, 1, 1, 1)
    ))

exemption_policies_state <- exemption_policies |> filter(State == state_title)
exemption_state <- exemption |>
    filter(geography == state_title) |>
    filter(school_year == "2024-25")
exemption_state_year_before <- exemption |>
    filter(geography == state_title) |>
    filter(school_year == "2023-24")
exemption_us <- exemption |>
    filter(geography == "United States") |>
    filter(school_year == "2024-25")
first_box <- exemption_policies_state |> pull("Personal Exemption") |> toupper()
second_box <- exemption_policies_state |>
    pull("Religious Exemption") |>
    toupper()
third_box <- exemption_state |> pull("estimate_percent") |> round(1)
third_box_label <- paste0(third_box, "%")
fourth_box <- exemption_us |> pull("estimate_percent") |> round(1)
fourth_box_label <- paste0(fourth_box, "%")
third_box_before <- exemption_state_year_before |> pull("estimate_percent")

is_universal_purchaser <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/universal_purchase_final.csv"
) |>
    filter(State == state_title) |>
    pull("Universal Purchase") |>
    toupper()

health_spending <- read_csv(
    "https://raw.githubusercontent.com/rfortherestofus/state-immunization-data/refs/heads/main/data-clean/health_spending_final.csv"
)
health_spending_state <- health_spending |>
    filter(State == state_title)
rank_spending <- health_spending_state |> pull("Rank") |> ordinal()
spending_state <- health_spending_state |>
    pull("Public Health Funding Per Capita ($)") |>
    round()
spending_us <- health_spending |>
    filter(State == "United States") |>
    pull("Public Health Funding Per Capita ($)") |>
    round()
spending_state_label <- paste0("$", spending_state)
spending_us_label <- paste0("$", spending_us)

us_states <- states() |>
    clean_names() |>
    select(name) |>
    filter(
        !name %in%
            c(
                "Commonwealth of the Northern Mariana Islands",
                "American Samoa",
                "United States Virgin Islands"
            )
    )

population_by_state <-
    get_decennial(
        geography = "state",
        variables = "P1_001N", # Total population variable
        year = 2020,
        survey = "pl" # PL 94-171 Redistricting Data
    ) |>
    select(NAME, value) |>
    rename(
        state = NAME,
        total_population = value
    ) |>
    arrange(desc(total_population))

df <- left_join(us_states, total_measles_cases, by = c("name" = "state"))

df_mmr_coverage_final <- mmr_coverage_final |>
    select(geography, school_year, estimate_percent) |>
    filter(school_year == "2024-25")

df_mmr <- left_join(
    df_mmr_coverage_final,
    population_by_state,
    by = c("geography" = "state")
)

mmr_line_df <- mmr_coverage_final |>
    select(geography, school_year, estimate_percent)

df_dtap_coverage_final <- dtap_coverage_final |>
    select(geography, year, estimate_percent) |>
    filter(year == "2023")

df_dtap <- left_join(
    df_dtap_coverage_final,
    population_by_state,
    by = c("geography" = "state")
)

dtap_line_df <- dtap_coverage_final |>
    select(geography, year, estimate_percent)
```

```{r}
#| output: asis
is_above_national_comparison <- df_dtap |>
    filter(geography %in% c(state_title, "United States")) |>
    summarise(
        higher_than_us = estimate_percent[geography == state_title] >
            estimate_percent[geography == "United States"]
    ) |>
    pull(higher_than_us)
if (is_above_national_comparison) {
    label_national_comparison <- "above"
} else {
    label_national_comparison <- "below"
}

if (third_box >= fourth_box) {
    label_median_comparison <- "higher"
} else {
    label_median_comparison <- "lower"
}

if (spending_state >= spending_us) {
    label_spending_comparison <- "higher"
} else {
    label_spending_comparison <- "lower"
}

transmission_label <- "low"

print(glue(
    "This brief illustrates the current status of childhood immunization in {state_title} and is intended to inform state-level policy decisions and priorities. Takeaways include:"
))
cat("\n\n")
cat(
    glue(
        "- State-level immunization coverage in {state_title} for key childhood vaccines, such as DTaP and MMR, is {label_national_comparison} than national averages.\n\n"
    ),
    glue(
        "- {state_title}'s non-medical exemption rate among kindergartners is {label_median_comparison} than the U.S. median.\n\n"
    ),
    glue(
        "- State-level per capita public health spending is {label_spending_comparison} than the national average.\n\n"
    ),
    glue(
        "- {state_title} has had relatively {transmission_label} levels of measles transmission in 2025."
    )
)
```

```{=typst} 
#blueline()
```

## Vaccination coverage

```{=typst}
#v(3pt)
```

```{r}
#| output: asis
print(glue(
    "Maintaining sufficient vaccination coverage is critical for establishing community protection. The charts below demonstrate how coverage for two critical vaccines has changed over time in {state_title} and how it compares to neighboring states, national averages, and Healthy People 2030 (HP2030) targets."
))
```


<div style="background-color: #F8F8F8;">

```{=typst}
#chart-title("Proportion of 2-year-olds fully protected with DTaP vaccines")
```

::: {layout="[[1,1]]"}

```{r}
dtap_line_df |> dtap_vaccination_over_time_chart_lollipop(state_title)
```

```{r}
df_dtap |> dtap_vaccination_comparison_chart(df, state_title)
```

:::

```{r}
is_above_yoy_comparison <- dtap_line_df |>
    filter(geography == state_title, year %in% c(2022, 2023)) |>
    summarise(
        increase = estimate_percent[year == 2023] >
            estimate_percent[year == 2022]
    ) |>
    pull(increase) |>
    round()

if (is_above_yoy_comparison) {
    label_yoy_comparison <- "more"
} else {
    label_yoy_comparison <- "fewer"
}

coverage_state <- dtap_line_df |>
    filter(geography == state_title) |>
    filter(year == 2023) |>
    pull(estimate_percent) |>
    round()
if (coverage_state < 90) {
    label_target <- "below"
} else {
    label_target <- "above"
}

is_above_us <- df_dtap |>
    filter(geography %in% c(state_title, "United States")) |>
    summarise(
        higher = estimate_percent[geography == state_title] >
            estimate_percent[geography == "United States"]
    ) |>
    pull(higher)
if (is_above_us) {
    label_coverage_us <- "higher"
} else {
    label_coverage_us <- "lower"
}

text_content <- glue(
    "In 2023, {label_yoy_comparison} two-year-olds were fully vaccinated against diphtheria, tetanus, and pertussis (received all four doses of DTaP) in {state_title} compared to the previous year. {state_title} has {label_coverage_us} coverage than the US median. Coverage in {state_title} is {label_target} the HP2030 target of 90%."
)
```

```{=typst}
#box(inset: 10pt)[
  #text("`r text_content`")
  #source("Source: ChildVaxView")
]
```

</div>

```{=typst} 
#pagebreak()
```

<div style="background-color: #F8F8F8;">

```{=typst}
#chart-title("Proportion of kindergartners protected with MMR vaccines")
```

::: {layout="[[1,1]]"}

```{r}
mmr_line_df |> mmr_vaccination_over_time_chart_lollipop(state_title)
```


```{r}
df_mmr |> mmr_vaccination_comparison_chart(df, state_title)
```

:::

```{r}
is_decreasing_yoy <- mmr_coverage_final |>
    filter(
        geography == state_title,
        school_year %in% c("2023-24", "2024-25")
    ) |>
    summarise(
        decrease = estimate_percent[school_year == "2024-25"] <
            estimate_percent[school_year == "2023-24"]
    ) |>
    pull(decrease)

is_lower_us <- mmr_coverage_final |>
    filter(
        geography %in% c(state_title, "United States"),
        school_year == "2024-25"
    ) |>
    summarise(
        lower_than_us = estimate_percent[geography == state_title] <
            estimate_percent[geography == "United States"]
    ) |>
    pull(lower_than_us)

value <- mmr_coverage_final |>
    filter(
        geography == state_title,
        school_year == "2024-25"
    ) |>
    pull(estimate_percent)
is_below_target <- value < 95

if (is_decreasing_yoy) {
    label_comparison_yoy <- "lower"
} else {
    label_comparison_yoy <- "higher"
}

if (is_lower_us) {
    label_coverage <- "lower"
} else {
    label_coverage <- "higher"
}

if (is_below_target) {
    label_target <- "falls short of"
} else {
    label_target <- "exceeds"
}

text_content <- glue(
    "In 2024, a {label_comparison_yoy} proportion of kindergarteners received at least 1 dose of measles, mumps, and rubella (MMR) vaccine in {state_title} compared to the previous year. {state_title} has {label_coverage} coverage than the US median. Coverage in {state_title} {label_target} the HP2030 target of 95%."
)
```

```{=typst}
#box(inset: 10pt)[
  #text("`r text_content`")
  #source("Source: SchoolVaxView")
]
```

</div>

```{=typst} 
#blueline()
```

## Vaccination exemptions

```{=typst}
#box(inset: 10pt)[
  Many states allow children attending public school to receive vaccination exemptions for religious reasons or for personal reasons, sometimes referred to as "philosophical exemptions". Higher rates of non-medical exemptions have been linked with increased disease transmission.
]
```

<div style="background-color: #F8F8F8;">

```{r}
variation <- (third_box - third_box_before) / third_box_before
if (variation >= 0.0) {
    variation_label <- "increase"
} else {
    variation_label <- "decrease"
}
additional_details <- exemption_policies_state |>
    pull(
        "Additional Details on Exemption Exceptions & Educational Requirements"
    ) |>
    as.character()
if (is.na(additional_details)) {
    additional_details <- ""
    heading_ad <- ""
} else {
    heading_ad <- "Additional details on exemption requirements:"
}
text_content <- glue(
    "{state_title}'s rate of non-medical exemptions among kindergartners during the 2024-25 school year is a slight {variation_label} from the state's 2023-24 rate."
)
```

```{=typst}
#box(
  inset: 1em,
  [
    #grid(
      columns: (1fr, 1fr, 1fr, 1fr),
      gutter: 1em,
      [#status-boxes(top-text: "Allows personal exemptions?", bottom-text: "`r first_box`")],
      [#status-boxes(top-text: "Allows religious exemptions?", bottom-text: "`r second_box`")],
      [#status-boxes(top-text: "Non-medical exemptions — state", bottom-text: "`r third_box_label`")],
      [#status-boxes(top-text: "Non-medical exemptions — US median", bottom-text: "`r fourth_box_label`")]
    )
  ]
)
#box(inset: 10pt)[
  #text("`r text_content`") \ \
  #text(weight: "bold", "`r heading_ad`") \
  #text("`r additional_details`")
  #source("Source: NCSL, SchoolVaxView")
]
```

</div>

```{=typst}
#pagebreak()
#blueline()
```

## PUBLIC HEALTH SPENDING

<div style="background-color: #F8F8F8;">

```{r}
text_content <- glue(
    "Low levels of public health spending are thought to contribute to suboptimal immunization rates. Nationally, {state_title} ranks {rank_spending} in public health spending."
)
```

```{=typst}
#box(inset: 10pt)[
  #grid(
    columns: (70%, 1fr),
    column-gutter: 8pt,
    align: horizon,
    [#text("`r text_content`")],

    stack(
      dir: ttb,
      spacing: 6pt,
      align(center + horizon)[
        #text(weight: "bold", size: 10pt)[State dollars dedicated to public health per capita (2022-23)]
      ],
      grid(
        columns: (auto, auto, auto),
        column-gutter: 12pt,
        row-gutter: 6pt,
        align(center + horizon)[State],
        [],
        align(center + horizon)[National],
        ..connected-boxes(text1: "`r spending_state_label`", text2: "`r spending_us_label`")
      )
    )
  )
  #source("Source: America's Health Rankings")
]
```

</div>

```{=typst} 
#blueline()
```

## UNIVERSAL VACCINE PURCHASING

<div style="background-color: #F8F8F8;">

```{=typst}
#box(inset: 10pt)[
  #grid(
    columns: (70%, 1fr),
    column-gutter: 20pt,
    align: horizon,
    [In states with Universal Purchase programs, the state government purchases all recommended vaccines for all children, regardless of insurance status. These initiatives can help to address disparities in vaccine coverage and support equitable vaccine access.],
    status-boxes(top-text: "Universal Purchaser?", bottom-text: "`r is_universal_purchaser`")
  )
  #source("Source: AIM")
]
```

</div>

```{=typst} 
#blueline()
```

## SUPPORT FOR IMMUNIZATION

Strong policy commitment to immunization is critical for effective vaccination programs. The state legislature has recently introduced several bills that would affect state-wide childhood vaccination, a selection of which are described below. The arrows below indicate whether these bills would strengthen (↑) or weaken (↓) vaccine safety nets.

<div style="background-color: #F8F8F8;">

```{=typst}
#box(inset: 10pt)[
  #list(
    marker: image("assets/down-arrow.png", width: 23pt)
  )[HB1315 (enacted) – Broadens pharmacists' immunization roles and mandates health insurers cover all CDC-recommended childhood vaccinations.]
  #list(
    marker: image("assets/down-arrow.png", width: 23pt)
  )[HB974 (enacted): Authorizes the health commissioner to establish regulations requiring health insurers to cover all vaccines recommended by the Advisory Committee on Immunization Practices (ACIP)]
  #list(
    marker: image("assets/up-arrow.png", width: 23pt)
  )[SB821/HB608 (proposed) – Would extend the temporary school admission period for students lacking required immunizations from 20 to 60 days.]
  #source("Source: AIM, LegiScan")
]
```

</div>

```{=typst} 
#pagebreak()
#blueline()
```

## DISEASE STATUS

```{r}
text_content <- glue(
    "Measles outbreaks can indicate insufficient vaccination coverage within a population. Disease may spread across state borders when vaccine coverage is low. The map below visualizes the number of measles cases reported in {state_title} and neighboring states between January 1, 2025, and {params$end_date}."
)
```

<div style="background-color: #F8F8F8;">

::: {layout="[[1,1]]"}

```{=typst} 
#box(inset: 10pt)[
    #align(horizon)[#text("`r text_content`")]
]
```

```{r}
#| fig-height: 4
#| fig-width: 6
df |> measles_map(state_title)
```

```{=typst} 
#source("Source: ChildVaxView")
```

:::

</div>

```{=typst} 
#box(
  inset: 1em,
  fill: rgb("#002D72"),
  [
    #grid(
      columns: (1fr, 10fr),
      gutter: 0.1em,
      align: horizon,
      [#image("assets/coins.svg")],
      [#text(
        font: "Gentona",
        size: 11pt,
        fill: white
      )[Vaccines can help prevent expensive disease outbreaks. A 2018–19 measles outbreak in Washington was estimated to cost #text(fill: rgb("#f1c400"))[US\$47,479] per case for both direct medical and public health response expenses.]]
    )
    #place(
      bottom + right,
      dy: 3pt,
      source(color: white, "Source: Pike, 2022")
    )
  ]
)
```

```{=typst} 
#blueline()
```

## DATA SOURCES

```{=typst}
#show list: set block(spacing: 0.5em) // reduce line height
#set text(size: 9pt) // reduce all text font size
```

Vaccination coverage:

- DTaP: CDC, ChildVaxView Interactive! https://www.cdc.gov/childvaxview/about/interactive-reports.html. DTaP, ≥ 4 Doses, States/Local Areas, Birth Years/Cohorts 2017–2021, Age 24 months. Updated Aug 2024. 
MMR: CDC, SchoolVaxView Interactive! https://www.cdc.gov/schoolvaxview/data/index.html. MMR, States, School Years 2021-22, 2022-23, 2023-24, 2024-25. Updated July 2025.

Vaccination exemptions:

- Status: NCSL, State Non-Medical Exemptions From School Immunization Requirements. https://www.ncsl.org/health/state-non-medical-exemptions-from-school-immunization-requirements. Updated July 2025.
Rates: CDC, SchoolVaxView Interactive! https://www.cdc.gov/schoolvaxview/data/index.html. Exemption – Non-Medical Exemption, States, School Years 2023-24 and 2024-25. Updated July 2025.

Public health spending:

- Public Health Funding in United States, America's Health Rankings, United Health Foundation. https://www.americashealthrankings.org/explore/measures/PH_funding. Accessed July 2025.

Universal vaccine purchasing:

- Association of Immunization Managers, Policy Maps – Universal Vaccine Purchase Program. https://www.immunizationmanagers.org/resources/aim-policy-maps/. Updated April 2025.

Support for immunization:

- Association of Immunization Managers, Legislative Round-ups. https://www.immunizationmanagers.org/resources-toolkits/immunization-program-policy-toolkit/legislative-round-ups/. 
LegiScan. https://legiscan.com/. Accessed July 2025.

Disease status:

- International Vaccine Access Center, U.S. Measles Tracker. https://publichealth.jhu.edu/ivac/resources/us-measles-tracker. Accessed July 22, 2025.

Measles outbreak cost:

- Pike J, Melnick A, Gastañaduy PA, et al. Societal Costs of a Measles Outbreak. Pediatrics. 2021;147(4):e2020027037. doi:10.1542/peds.2020-027037

*Note: The high-level data included in this report do not reflect statewide variation in vaccination coverage or disease status. Further, state reporting policies may limit data completeness. For any data-related questions, please contact ivac@jh.edu.*
